@using UIComponents.Abstractions.Interfaces;
@using UIComponents.Abstractions.Interfaces.ExternalServices;
@using UIComponents.Abstractions.Extensions;
@using UIComponents.Abstractions.Models;
@using UIComponents.Models;

@using UIComponents.Models.Models;
@using UIComponents.Models.Models.Actions;
@using UIComponents.Models.Models.Buttons;
@using UIComponents.Models.Models.Dropdown;
@using UIComponents.Models.Models.Icons;
@using UIComponents.Models.Models.Inputs;
@using UIComponents.Models.Models.Texts;
@using UIComponents.Web.Extensions;


@model UICActions
@{
    string identifier = Model.Id();
    if(string.IsNullOrEmpty(identifier))
        throw new Exception("Identifier for Actions not defined");

    Model.AssignCollectionForChildren();

    Model.AddScript(
    @<text>
        @if (Model.OnClick.HasValue())
                {
        <text>
            $('#@Html.Raw(identifier)').click(async function (args) {
            @await Model.OnClick.InvokeAsync(Component)
            });
        </text>
                }

        @if (Model.OnChange.HasValue())
        {
        <text>
            $('#@Html.Raw(identifier)').keyup(async function (args) {
                @await Model.OnChange.InvokeAsync(Component)
            });
        </text>
        }

        @if (Model.AfterChange.HasValue())
                {
        <text>
            $('#@Html.Raw(identifier)').change(async function (args) {
                @await Model.AfterChange.InvokeAsync(Component)
            });
        </text>
                }

        @if (Model.OnFocus.HasValue())
                {
        <text>
            $('#@Html.Raw(identifier)').focus(async function (args) {
                @await Model.OnFocus.InvokeAsync(Component)
            });
        </text>
                }

        @if (Model.OnLoseFocus.HasValue())
                {
        <text>
            $('#@Html.Raw(identifier)').blur(async function (args) {
                @await Model.OnLoseFocus.InvokeAsync(Component)
            });
        </text>
                }
    </text>);
}

@await Model.RenderStylesAndScripts(Component)